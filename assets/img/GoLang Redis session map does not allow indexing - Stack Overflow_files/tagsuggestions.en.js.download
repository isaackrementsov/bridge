StackExchange.tagSuggestions=function(){function e(e){c=e||{},a=$("#tag-suggestions"),o=$("#tagnames"),o.change(function(){r()}),s=StackExchange.helpers.DelayedReaction(i,1e4,{"sliding":!0}),$("#post-form").submit(function(){$(this).find("input[name='tag-suggestions']").remove().end().append(t())}),$("#wmd-input").on("keydown",function(){s.trigger()}).on("blur",function(){StackExchange.cardiologist.ensureDraftSaved(function(e){e&&e.suggestedTags&&n(e.suggestedTags),i(),s.cancel()},!0)})}function t(){var e="";for(var t in u)u.hasOwnProperty(t)&&/^t_/.test(t)&&(e+=t.replace(/^t_/," "));return $("<input type='hidden' name='tag-suggestions' />").val(e.substring(1))}function n(e){l=e}function i(){r(l)}function r(e){if(a){if(e=e||d,d=e,!e.length)return a.empty(),void 0;!u.anything&&c.onFirstSuggestion&&c.onFirstSuggestion.call(),u.anything=1,a.html("<span>suggested tags:</span>");for(var t=function(e){return new RegExp("(?:^|\\s)"+e.replace(/[.+]/g,"\\$&")+"(?:$|\\s)","i").test(o.val())},n=0;n<e.length;n++){var i=e[n];u["t_"+i]=1;var r=!t(i),s=window.tagRenderer(i,null,r?"a":"span");r&&s.click(function(e){if(!e.ctrlKey&&1==e.which){e.preventDefault();var n=$(this).text(),i=this;if(setTimeout(function(){$(i).replaceWith(window.tagRenderer(n,null,"span"))},0),t(n))return o.focus(),void 0;$("#tag-menu").parent().remove(),o[0].func_add(n)}}),a.append(s)}}}var a,o,s,c,l=[],u={},d=[];return{"init":e,"suggest":n}}();